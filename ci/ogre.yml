steps:
  - script: sudo apt-get install libxaw7-dev libzzip-dev libxrandr-dev libfreetype6-dev libxt-dev libgles2-mesa-dev mesa-common-dev libgl1-mesa-dev libglu1-mesa-dev  nvidia-cg-dev libpugixml-dev qtbase5-dev
    displayName: 'Install ogre dependencies'
    condition: eq(variables['Agent.OS'], 'Linux')

  - script: git clone --recursive --branch v1.12.6 --depth 1 https://github.com/OGRECave/ogre.git $(Build.BinariesDirectory)/ThirdParty/Ogre-sources
    displayName: 'Download Ogre sources'

  - task: CMake@1
    inputs:
      workingDirectory: $(Build.BinariesDirectory)/ThirdParty/Ogre
      cmakeArgs: $(Build.BinariesDirectory)/ThirdParty/Ogre-sources -DCMAKE_BUILD_TYPE=MinSizeRel -DOGRE_BUILD_COMPONENT_PYTHON=OFF -DOGRE_BUILD_COMPONENT_JAVA=OFF -DOGRE_BUILD_COMPONENT_CSHARP=OFF -DOGRE_BUILD_TESTS=OFF -DOGRE_BUILD_SAMPLES=OFF -DOGRE_BUILD_TOOLS=OFF
    displayName: 'Configure Ogre'

  - task: CMake@1
    inputs:
      workingDirectory: $(Build.BinariesDirectory)/ThirdParty/Ogre
      cmakeArgs: --build $(Build.BinariesDirectory)/ThirdParty/Ogre --config MinSizeRel
    displayName: 'Build Ogre'

  - task: CMake@1
    inputs:
      workingDirectory: $(Build.BinariesDirectory)/ThirdParty/Ogre
      cmakeArgs: --install $(Build.BinariesDirectory)/ThirdParty/Ogre --prefix $(Build.SourcesDirectory)/libs/Ogre --config MinSizeRel
    displayName: 'Install'
